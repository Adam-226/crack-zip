# ZIP密码破解工具

一个强大的多线程 ZIP 密码破解工具，支持断点续传和实时进度显示。使用 Python 编写，能够高效破解纯数字密码的 ZIP 文件。

## 核心特性

- **高性能破解** - 内存直接验证，速度达 20,000-50,000 密码/秒
- **多线程并行** - 充分利用多核 CPU，自动使用所有核心
- **断点续传** - 按 Ctrl+C 安全中断，下次自动从断点继续
- **实时进度显示** - 显示破解速度、完成百分比和预计剩余时间
- **智能 ZIP 检测** - 正确处理各种类型的 ZIP 文件（包括"需要密码但未加密"的特殊情况）
- **完整性保证** - 暴力遍历所有可能组合，确保不遗漏任何密码

## 快速开始

```bash
python crack_zip_multithreaded.py [zip文件名] [最小位数] [最大位数] [线程数]
```

**参数说明：**
- `zip文件名` - 要破解的位于当前目录下的 ZIP 文件（如 myfile.zip）
- `最小位数` - 密码最小位数（默认 3）
- `最大位数` - 密码最大位数（默认 5）
- `线程数` - 并行线程数

### 使用示例

```bash
# 破解指定文件，尝试 3-5 位数字密码
python crack_zip_multithreaded.py myfile.zip 3 5

# 如果知道密码是 4 位，可以只尝试 4 位
python crack_zip_multithreaded.py myfile.zip 4 4

# 手动指定使用 8 个线程
python crack_zip_multithreaded.py myfile.zip 3 5 8

# 尝试 6 位密码（注意：会花费较长时间）
python crack_zip_multithreaded.py myfile.zip 6 6
```

## 工作原理

### 破解流程

1. **文件验证** - 检查 ZIP 文件是否存在且有效
2. **密码检测** - 尝试无密码解压，判断是否需要密码
3. **多线程破解** - 创建多个工作线程，并行尝试密码组合
4. **进度保存** - 每 10000 次尝试自动保存检查点
5. **结果输出** - 找到密码或尝试完所有组合后报告结果

### 断点续传机制

- 程序会自动创建 `[文件名]_checkpoint.json` 检查点文件
- 按 Ctrl+C 中断时，进度会立即保存
- 下次运行相同命令，自动从上次中断处继续
- 找到密码或完成所有尝试后，检查点文件会自动删除

### 性能优化

脚本采用了多种优化策略：

1. **内存直接读取** - 不解压到磁盘，直接在内存中读取文件内容验证密码（速度提升 5-10 倍）
2. **智能文件选择** - 自动选择 ZIP 中最小的文件进行密码测试，并缓存结果
3. **批量处理** - 密码按批次（500个/批）分发给线程，减少线程同步开销
4. **最小化锁竞争** - 优化锁的使用范围，提高并发效率
5. **动态进度更新** - 每 2 秒更新一次进度信息

## 使用建议

### 优化破解速度

1. **限制密码范围** - 如果有线索，缩小搜索范围可大幅减少时间
   ```bash
   # 从 3-5 位改为 4 位，减少 90% 的尝试次数
   python crack_zip_multithreaded.py file.zip 4 4
   ```

2. **调整线程数** - 默认使用所有核心，但可根据需要调整
   ```bash
   # 减少 CPU 占用，使用 4 个线程
   python crack_zip_multithreaded.py file.zip 3 5 4
   ```

3. **大文件处理** - 对于大型 ZIP 文件（如 GB 级别），多线程优势更明显

### 断点续传使用

```bash
# 开始破解
python crack_zip_multithreaded.py largefile.zip 3 6

# 按 Ctrl+C 中断（进度自动保存）
# 输出：进度已保存到 largefile.zip_checkpoint.json

# 稍后继续（使用相同命令）
python crack_zip_multithreaded.py largefile.zip 3 6
# 输出：从上次中断处继续: 已尝试 45000 个密码
```

### 系统资源管理

- **高 CPU 使用率是正常的** - 多线程破解会充分利用 CPU
- **如果系统卡顿** - 手动减少线程数
- **内存占用** - 通常很低，每个线程只需少量内存
- **磁盘 I/O** - 使用内存验证，几乎无磁盘写入操作

## 技术说明

### ZIP 文件类型支持

本工具能够正确处理以下类型的 ZIP 文件：

1. **普通 ZIP** - 不需要密码的文件
2. **密码保护但未加密** - 只有密码检查，无内容加密
3. **密码保护且加密** - 标准加密 ZIP 文件

### 检测机制

- **不依赖文件头标志** - 之前的方法可能误判
- **内存直接验证** - 在内存中打开文件并读取内容验证密码
- **智能错误处理** - 区分密码错误、文件损坏等不同情况
- **完整遍历保证** - 使用 `itertools.product` 生成所有可能组合，确保无遗漏

### 线程安全设计

- `count_lock` - 保护密码尝试计数
- `test_file_lock` - 保护测试文件信息缓存
- `password_found` 标志 - 找到密码后立即终止所有线程（0.1 秒内响应）

## 限制和注意事项

### 重要提醒

- **仅用于合法用途** - 只能破解您自己拥有的 ZIP 文件
- **纯数字密码** - 不支持字母、符号或混合密码
- **时间成本** - 长密码需要大量时间（7 位数字可能需要数小时）
- **无法保证成功** - 如果密码不在指定范围内，无法找到

### 法律声明

未经授权访问他人文件可能违反法律。本工具仅供以下合法用途：
- 恢复自己忘记的 ZIP 密码
- 安全测试和教育目的
- 合法授权的密码恢复服务

使用本工具即表示您同意仅将其用于合法目的。

## 扩展建议

如果需要破解非纯数字密码，可以考虑：

1. **添加字母支持** - 修改 `generate_passwords` 方法，使用 `string.ascii_lowercase` 等
2. **字典攻击** - 使用常用密码字典而非暴力破解
3. **掩码攻击** - 如果知道密码模式（如"字母+数字"）
4. **GPU 加速** - 使用专业工具如 Hashcat（需要提取 ZIP hash）

## 贡献和反馈

如果您有任何问题、建议或改进想法，欢迎提出！
